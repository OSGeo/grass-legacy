<TITLE>r.volume</TITLE>

<body bgcolor="white">

<img src="grass.smlogo.gif">

<hr width=100% align=center size=6 no shade>

<H2>NAME</H2>

<EM><b>r.volume</b></EM>  - Calculates the volume of data "clumps", 
and (optionally) produces a GRASS <EM>site_lists</EM> file 
containing the calculated centroids of these clumps. 
<BR>
<EM>(GRASS Raster Program)</EM>

<H2>SYNOPSIS</H2>

<B>r.volume</B> 
<BR>
<B>r.volume help</B> 
<BR>
<B>r.volume</B> 
[<B>-fq</B>] 
<B>data=</B><EM>name</EM> 
[<B>clump=</B><EM>name</EM>] 
[<B>site_list=</B><EM>name</EM>]

<H2>DESCRIPTION</H2>

This program computes the cubic volume of data contained 
in user-defined clumps. 
<EM>r.volume</EM> outputs: 
<OL>
<LI>The category value assigned to each clump formed by 
the <EM>clump</EM> map layer. 
This value is stored under the "Cat Number" column (field 1) 
in the output table. 

<LI>The average category value of the cells found in a <EM>data</EM> 
map that fall within the boundaries of each clump in a <EM>clump</EM> map. 
The table stores this value under the "Average in Clump" column (field 2). 

<LI>The summed total value of the category values assigned to the cells 
falling within each of these clumps. 
This value is output under the "Data Total" column (field 3). 

<LI>The number of cells from the <EM>data</EM> map that fall 
within the boundaries of each clump formed by the <EM>clump</EM> map layer. 
This cell count is stored under the "# Cells in Clump" column (field 4) in the 
output table. 

<LI>The centroid easting of each clump.
<LI>The centroid northing of each clump. These values are output 
under the "Centroid Easting" and "Centroid Northing" columns (fields 5 and 6) 
in the output. 

<LI>The total "volume" of each clump. For each clump, the volume is calculated 
by multiplying the area of each cell by its category value, and 
taking the sum of this value for all cells within the clump. Since, 
in GRASS, each cell in the <EM>data</EM> map 
will have the same cell dimensions (i.e., the same area), this is equivalent to 
multiplying the area of one cell by the "Data Total" column (field 3). 
<BR>
(The area of each cell is equal to the product of its east-west resolution 
by its north-south resolution. See 
<EM><A HREF="g.region.html">g.region</A></EM>.)
</OL>

<P>

Results are sent to standard output in the form of a
table.  If the user sets the <B>-f</B> flag, this table
will be output in a form suitable for input to such UNIX
programs as <EM>awk</EM> and <EM>sed</EM>; the table's
columns are stored as colon-separated fields.  The user can
also (optionally) elect to store clump centroids in a GRASS
<EM>site_lists</EM> file. A sample output report is shown
below.

<P>

<EM>r.volume</EM>
works with the current geographic region definitions 
and respects the current MASK. 

<P>

The user can run <EM>r.volume</EM> non-interactively by 
specifying parameter values 
on the command line. If the user omits parameter 
values from the command line, 
the program will prompt the user for input using the standard 
interface described 
in the manual entry for 
<EM><A HREF="parser.html">parser</A></EM>.

<H2>OPTIONS</H2>

<H3>Flags:</H3>

<DL>
<DT><B>-f</B>
<DD>Generate unformatted output. 
Output is in a form suitable for input to UNIX programs like <EM>awk</EM>;
each column in the output is separated by a colon. Results are sent to 
standard output. 

<DT><B>-q</B>
<DD>Run quietly, suppressing the printing of debugging messages to standard 
output. 
</DL>

<H3>Parameters:</H3>

<DL>

<DT><B>data=</B><EM>name</EM> 
<DD>Name of an existing raster map layer containing the category 
values to be summed. The cell resolution (area) of the <B>data</B> 
map will also be used. 

<DT><B>clump=</B><EM>name</EM>
<DD>Name of an existing raster map layer that defines the boundaries 
of each clump. Preferably, this map should be the output of 
<EM><A HREF="r.clump.html">r.clump</A></EM>.
If the user has imposed a mask, the program uses this mask as the 
<B>clump</B> map layer if no other <B>clump</B> layer is 
specified by the user. 

<DT><B>site_list=</B><EM>name</EM>
<DD>The name to be assigned to a new GRASS <B>site_list</B> file, 
in which clump centroids can be stored. 

</DL>

<H2>EXAMPLE OF REPORT</H2>

The following report might be generated by the command: 
<DL>
<DD>
<B>r.volume</B> <B>d=</B><EM>elevation</EM> 
<B>c=</B><EM>fields.only</EM> <B>s=</B><EM>field.centers</EM>
</DL>

<PRE>
Cat  Average   Data  # Cells       Centroid             Total
 #   in clump  Total in clump Easting   Northing       Volume
 1   1181.09   75590     64  595500.0  4927700.0   755900000.0
 2   1163.50   69810     60  597100.0  4927700.0   698100000.0
 3   1146.83   34405     30  598300.0  4927700.0   344050000.0
 4   1193.20  366311    307  599400.0  4927300.0  3663110000.0
     .....
     .....
60   1260.08  351563    279  603100.0  4921000.0  3515630000.0
61   1213.93   35204     29  603700.0  4921500.0   352040000.0
62   1207.71   33816     28  604100.0  4921500.0   338160000.0
                                  Total Volume = 67226740000.0
</PRE>

<P>

For ease of example, it is assumed that each clump in the 
<EM>fields.only</EM> map layer is a field, that cell category 
values in the <EM>elevation</EM> map layer represent 
actual elevation values in meters, and that the data base 
is a UTM data base (in meters). 
This means that field #1 (clump #1) contains 64 cells; 
the average elevation in field #1 is 1181.09 meters. The 
sum of all of the elevation values assigned to cells 
within field #1 is 75590 meters. The volume (x*y*z) of 
space in field #1 is equal to 755900000 cubic meters. 

<P>
The "Data Total" column is the sum of the cell category values appearing in the 
<EM>elevation</EM> map layer, within each field of the <EM>fields.only</EM> map layer. 
The Total Volume is the sum multiplied 
by the e-w resolution times the n-s resolution. 

<H2>CENTROIDS</H2>

The coordinates of the clump centroids are the same as those stored 
in the GRASS <EM>site_lists</EM> file (if one was requested). 
They are guaranteed to 
fall on a cell of the appropriate category; thus, they are not always the true, 
mathematical centroids. However, they will always fall at a cell center. 

<H2>FORMAT OF SITE LIST</H2>

For each line of above table the GRASS <EM>site_lists</EM> file reads: 

<P>
<DL>
<DD>
easting|northing|#cat v=</B>volume a=</B>average t=</B>sum n=</B>count 
</DL>

<P>

This can be converted directly to a raster map layer in which each point 
is assigned to a separate category. 

<H2>APPLICATIONS</H2>

By preprocessing the <EM>elevation</EM> map layer with 
<EM><A HREF="r.mapcalc.html">r.mapcalc</A></EM> 
and using suitable masking or clump maps, very interesting 
applications can be done with <EM>r.volume</EM>. 
For instance, one can calculate: the volume 
of rock in a potential quarry; cut/fill volumes for roads; and, 
water volumes in potential reservoirs. 
Data layers of other measures of real values can also be used. 

<H2>NOTES</H2>

The output is sent to the terminal screen. The user can capture 
the output in a file using the UNIX redirection mechanism, as in the 
following example: 
<DL>
<DD>
<B>r.volume</B> 
<B>d=</B><EM>data_map</EM> 
<B>c=</B><EM>clump_map</EM> 
<B>s=</B><EM>site_list</EM> &gt; <EM>table.out</EM> 
</DL>

<P>

Output can also be sent directly to the printer, as shown below: 
<DL>
<DD>
<B>r.volume</B> 
<B>d=</B><EM>data_map</EM> 
<B>c=</B><EM>clump_map</EM> 
<B>s=</B><EM>site_list</EM> | lpr
</DL>

<P>
The user should be aware of what units of measurement 
the cell e-w and n-s resolution are in, 
and in what units the <EM>data</EM> map's cell category values are stated 
(since these three values will be multiplied together to produce the volume). 

<P>
This program respects the current mask, and uses this mask as the 
<EM>clump</EM> map layer if none is specified by the user. 

<H2>SEE ALSO</H2>

<EM><A HREF="g.region.html">g.region</A></EM><br>
<EM><A HREF="r.clump.html">r.clump</A></EM><br>
<EM><A HREF="r.mapcalc.html">r.mapcalc</A></EM><br>
<EM><A HREF="r.mask.html">r.mask</A></EM><br>
<EM><A HREF="s.db.rim.html">s.db.rim</A></EM><br>
<EM><A HREF="s.menu.html">s.menu</A></EM><br>
<EM><A HREF="parser.html">parser</A></EM>

<H2>AUTHOR</H2>

Dr. James Hinthorne, 
GIS Laboratory, 
Central Washington University
